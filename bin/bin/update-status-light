#!/usr/bin/env fish

cd ~/projects/department-for-education/cpd/ecf2/

set build_status

set build_status (gh run list --branch main --workflow Deploy --limit 1 --json status | jq '.[0].status' | string replace -a '"' '')

# {queued|completed|in_progress|requested|waiting|pending|action_required|cancelled|failure|neutral|skipped|stale|startup_failure|success|timed_out}
switch $build_status
  case completed
    busylight --dim 50 on green
  case in_progress
    busylight --dim 50 on orange
  case failure
    busylight --dim 50 on red
end
